{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nconst PlannerProgress = () => {\n  _s();\n  const [progressData, setProgressData] = useState(null);\n  const [error, setError] = useState(null);\n  const fetchProgress = async () => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      setError(\"No auth token found. Please login.\");\n      return;\n    }\n    try {\n      const res = await fetch(\"http://localhost:5000/api/planner/progress\", {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const data = await res.json();\n      if (!res.ok) {\n        if (res.status === 404) {\n          setError(\"No active spending plan found. Create one first!\");\n          setProgressData(null);\n          return;\n        }\n        throw new Error(data.message || \"Failed to load progress\");\n      }\n      setProgressData(data.categories);\n      setError(null);\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n  useEffect(() => {\n    fetchProgress();\n    const handleExpenseAdded = async e => {\n      const {\n        category,\n        amount\n      } = e.detail || {};\n\n      // Optimistic update only if we have existing data\n      if (progressData && category && amount) {\n        setProgressData(prev => {\n          var _prev$category;\n          return {\n            ...prev,\n            [category]: {\n              ...prev[category],\n              spent: (((_prev$category = prev[category]) === null || _prev$category === void 0 ? void 0 : _prev$category.spent) || 0) + amount\n            }\n          };\n        });\n      }\n\n      // Always sync with server after 2 seconds\n      setTimeout(fetchProgress, 2000);\n    };\n    window.addEventListener(\"expenseAdded\", handleExpenseAdded);\n    return () => window.removeEventListener(\"expenseAdded\", handleExpenseAdded);\n  }, []);\n\n  // ... rest of the component remains the same\n};\n_s(PlannerProgress, \"tnwPLRCMaONKwhrF6r23GAMoz+c=\");\n_c = PlannerProgress;\nexport default PlannerProgress;\nvar _c;\n$RefreshReg$(_c, \"PlannerProgress\");","map":{"version":3,"names":["React","useEffect","useState","PlannerProgress","_s","progressData","setProgressData","error","setError","fetchProgress","token","localStorage","getItem","res","fetch","headers","Authorization","data","json","ok","status","Error","message","categories","err","handleExpenseAdded","e","category","amount","detail","prev","_prev$category","spent","setTimeout","window","addEventListener","removeEventListener","_c","$RefreshReg$"],"sources":["C:/Users/HP/Documents/Budgetly/client/src/components/PlannerProgress.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n\r\nconst PlannerProgress = () => {\r\n  const [progressData, setProgressData] = useState(null);\r\n  const [error, setError] = useState(null);\r\n\r\n  const fetchProgress = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) {\r\n      setError(\"No auth token found. Please login.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const res = await fetch(\"http://localhost:5000/api/planner/progress\", {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n\r\n      const data = await res.json();\r\n      \r\n      if (!res.ok) {\r\n        if (res.status === 404) {\r\n          setError(\"No active spending plan found. Create one first!\");\r\n          setProgressData(null);\r\n          return;\r\n        }\r\n        throw new Error(data.message || \"Failed to load progress\");\r\n      }\r\n\r\n      setProgressData(data.categories);\r\n      setError(null);\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProgress();\r\n\r\n    const handleExpenseAdded = async (e) => {\r\n      const { category, amount } = e.detail || {};\r\n      \r\n      // Optimistic update only if we have existing data\r\n      if (progressData && category && amount) {\r\n        setProgressData(prev => ({\r\n          ...prev,\r\n          [category]: {\r\n            ...prev[category],\r\n            spent: (prev[category]?.spent || 0) + amount\r\n          }\r\n        }));\r\n      }\r\n\r\n      // Always sync with server after 2 seconds\r\n      setTimeout(fetchProgress, 2000);\r\n    };\r\n\r\n    window.addEventListener(\"expenseAdded\", handleExpenseAdded);\r\n    return () => window.removeEventListener(\"expenseAdded\", handleExpenseAdded);\r\n  }, []);\r\n\r\n  // ... rest of the component remains the same\r\n};\r\n\r\nexport default PlannerProgress;\r\n\r\n\r\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAElD,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGJ,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACK,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAC,IAAI,CAAC;EAExC,MAAMO,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAI,CAACF,KAAK,EAAE;MACVF,QAAQ,CAAC,oCAAoC,CAAC;MAC9C;IACF;IAEA,IAAI;MACF,MAAMK,GAAG,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACpEC,OAAO,EAAE;UAAEC,aAAa,EAAE,UAAUN,KAAK;QAAG;MAC9C,CAAC,CAAC;MAEF,MAAMO,IAAI,GAAG,MAAMJ,GAAG,CAACK,IAAI,CAAC,CAAC;MAE7B,IAAI,CAACL,GAAG,CAACM,EAAE,EAAE;QACX,IAAIN,GAAG,CAACO,MAAM,KAAK,GAAG,EAAE;UACtBZ,QAAQ,CAAC,kDAAkD,CAAC;UAC5DF,eAAe,CAAC,IAAI,CAAC;UACrB;QACF;QACA,MAAM,IAAIe,KAAK,CAACJ,IAAI,CAACK,OAAO,IAAI,yBAAyB,CAAC;MAC5D;MAEAhB,eAAe,CAACW,IAAI,CAACM,UAAU,CAAC;MAChCf,QAAQ,CAAC,IAAI,CAAC;IAChB,CAAC,CAAC,OAAOgB,GAAG,EAAE;MACZhB,QAAQ,CAACgB,GAAG,CAACF,OAAO,CAAC;IACvB;EACF,CAAC;EAEDrB,SAAS,CAAC,MAAM;IACdQ,aAAa,CAAC,CAAC;IAEf,MAAMgB,kBAAkB,GAAG,MAAOC,CAAC,IAAK;MACtC,MAAM;QAAEC,QAAQ;QAAEC;MAAO,CAAC,GAAGF,CAAC,CAACG,MAAM,IAAI,CAAC,CAAC;;MAE3C;MACA,IAAIxB,YAAY,IAAIsB,QAAQ,IAAIC,MAAM,EAAE;QACtCtB,eAAe,CAACwB,IAAI;UAAA,IAAAC,cAAA;UAAA,OAAK;YACvB,GAAGD,IAAI;YACP,CAACH,QAAQ,GAAG;cACV,GAAGG,IAAI,CAACH,QAAQ,CAAC;cACjBK,KAAK,EAAE,CAAC,EAAAD,cAAA,GAAAD,IAAI,CAACH,QAAQ,CAAC,cAAAI,cAAA,uBAAdA,cAAA,CAAgBC,KAAK,KAAI,CAAC,IAAIJ;YACxC;UACF,CAAC;QAAA,CAAC,CAAC;MACL;;MAEA;MACAK,UAAU,CAACxB,aAAa,EAAE,IAAI,CAAC;IACjC,CAAC;IAEDyB,MAAM,CAACC,gBAAgB,CAAC,cAAc,EAAEV,kBAAkB,CAAC;IAC3D,OAAO,MAAMS,MAAM,CAACE,mBAAmB,CAAC,cAAc,EAAEX,kBAAkB,CAAC;EAC7E,CAAC,EAAE,EAAE,CAAC;;EAEN;AACF,CAAC;AAACrB,EAAA,CA5DID,eAAe;AAAAkC,EAAA,GAAflC,eAAe;AA8DrB,eAAeA,eAAe;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}